<!DOCTYPE HTML>
<html>
<head>
    <title>Registro de Usuario</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">

<div id="page-wrapper">

    <!-- Header -->
    <header id="header">
        <img src="images/logo.jpg" alt="" style="width: 70px; height: auto;">
    </header>

    <!-- Main -->
    <div id="main" class="wrapper style1">
        <div class="container">
            <header class="major">
                <h2>Registro de Usuario</h2>
                <p>Complete el formulario para crear su cuenta</p>
            </header>

            <section>
                <form id="registroForm">
                    <!-- Nombre -->
                    <label for="nombre">Nombre Completo *</label>
                    <input type="text" id="nombre" name="nombre" minlength="3" maxlength="50" placeholder="Ingrese su nombre completo"/>
                    <small class="error" id="errorNombre"></small>

                    <!-- Correo -->
                    <label for="correo">Correo Electr칩nico *</label>
                    <input type="email" id="correo" name="correo" pattern="^[a-zA-Z0-9._%+-]+@gmail\.com$" placeholder="tucorreo@gmail.com"/>
                    <small class="error" id="errorCorreo"></small>

                    <!-- Contrase침a -->
                    <label for="password">Contrase침a *</label>
                    <input type="password" id="password" name="password" minlength="6" maxlength="20" placeholder="6-20 caracteres"/>
                    <small class="error" id="errorPassword"></small>

                    <!-- Confirmar Contrase침a -->
                    <label for="confirmarPassword">Confirmar Contrase침a *</label>
                    <input type="password" id="confirmarPassword" name="confirmarPassword" placeholder="Repita la contrase침a"/>
                    <small class="error" id="errorConfirmarPassword"></small>

                    <!-- Tel칠fono -->
                    <label for="telefono">Tel칠fono (opcional)</label>
                    <input type="tel" id="telefono" name="telefono" placeholder="+56 9 1234 5678" pattern="(\+56)?\s?9\s?[0-9]{4}\s?[0-9]{4}" />
                    <small class="error" id="errorTelefono"></small>

                    <!-- Regi칩n -->
                    <label for="region">Regi칩n *</label>
                    <select id="region" name="region">
                        <option value="">Seleccione una regi칩n</option>
                        <option value="metropolitana">Regi칩n Metropolitana</option>
                        <option value="valparaiso">Valpara칤so</option>
                        <option value="biobio">Biob칤o</option>
                    </select>
                    <small class="error" id="errorRegion"></small>

                    <!-- Comuna -->
                    <label for="comuna">Comuna *</label>
                    <select id="comuna" name="comuna">
                        <option value="">Seleccione una comuna</option>
                    </select>
                    <small class="error" id="errorComuna"></small>

                    <br><br>
                    <button type="submit" class="button primary">Registrar</button>
                </form>
            </section>
        </div>
    </div>

    <!-- Footer -->
    <footer id="footer">
        <ul class="icons">
            <li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
            <li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
        </ul>
        <ul class="copyright">
            <li>&copy; Untitled. All rights reserved.</li><li>Design: HTML5 UP</li>
        </ul>
    </footer>
</div>

<script>
    const comunas = {
        metropolitana: ["Santiago", "Providencia", "칌u침oa", "Maip칰"],
        valparaiso: ["Valpara칤so", "Vi침a del Mar", "Quilpu칠"],
        biobio: ["Concepci칩n", "Talcahuano", "Chill치n"]
    };

    const regionSelect = document.getElementById("region");
    const comunaSelect = document.getElementById("comuna");

    regionSelect.addEventListener("change", function() {
        comunaSelect.innerHTML = '<option value="">Seleccione una comuna</option>';
        if(comunas[this.value]){
            comunas[this.value].forEach(c => {
                let option = document.createElement("option");
                option.value = c.toLowerCase();
                option.textContent = c;
                comunaSelect.appendChild(option);
            });
        }
    });

    const form = document.getElementById("registroForm");

    const campos = [
        {id:"nombre", min:3, max:50, msg:"El nombre debe tener entre 3 y 50 caracteres."},
        {id:"correo", pattern:/^[a-zA-Z0-9._%+-]+@gmail\.com$/, msg:"Debe ser un correo v치lido @gmail.com."},
        {id:"password", min:6, max:20, msg:"La contrase침a debe tener entre 6 y 20 caracteres."},
        {id:"confirmarPassword", compare:"password", msg:"Las contrase침as no coinciden."},
        {id:"telefono", pattern:/(\+56)?\s?9\s?[0-9]{4}\s?[0-9]{4}/, optional:true, msg:"Formato v치lido: +56 9 1234 5678"}
    ];

    campos.forEach(campo => {
        const input = document.getElementById(campo.id);
        const error = document.getElementById("error"+campo.id.charAt(0).toUpperCase() + campo.id.slice(1));

        // Mostrar mensaje al hacer focus
        input.addEventListener("focus", function(){
            error.style.color = "#ccc"; 
            error.textContent = campo.msg;
        });

        // Validaci칩n al salir del input
        input.addEventListener("blur", function(){
            let valido = true;
            if(campo.min && (input.value.length < campo.min || input.value.length > campo.max)) valido=false;
            if(campo.pattern && input.value && !campo.pattern.test(input.value)) valido=false;
            if(campo.compare){
                const pass = document.getElementById(campo.compare);
                if(input.value !== pass.value) valido=false;
            }
            if(valido) error.textContent = ""; else error.style.color = "#ff6666";
        });
    });

    form.addEventListener("submit", function(e){
        e.preventDefault();
        let valido = true;
        campos.forEach(campo=>{
            const input = document.getElementById(campo.id);
            const error = document.getElementById("error"+campo.id.charAt(0).toUpperCase() + campo.id.slice(1));
            let fieldValido = true;
            if(campo.min && (input.value.length < campo.min || input.value.length > campo.max)) fieldValido=false;
            if(campo.pattern && input.value && !campo.pattern.test(input.value)) fieldValido=false;
            if(campo.compare){
                const pass = document.getElementById(campo.compare);
                if(input.value !== pass.value) fieldValido=false;
            }
            if(!fieldValido){
                error.style.color = "#ff6666";
                valido=false;
            } else {
                error.textContent="";
            }
        });
        if(regionSelect.value===""){document.getElementById("errorRegion").textContent="Selecciona una regi칩n."; valido=false;} else document.getElementById("errorRegion").textContent="";
        if(comunaSelect.value===""){document.getElementById("errorComuna").textContent="Selecciona una comuna."; valido=false;} else document.getElementById("errorComuna").textContent="";

        if(valido){
            alert("Registro exitoso 游꿀");
            form.reset(); // Borra los campos
            window.location.href = "index.html"; // Redirige a index.html
        }
    });
</script>

<style>
    input, select {
        background: transparent;
        color: white;
        border: 1px solid #ccc;
        padding: 10px;
        width: 100%;
        margin-bottom: 5px;
    }
    input::placeholder { color: #ddd; }
    label { color: white; font-weight: bold; }
    .error { font-size: 0.9em; margin-bottom: 10px; display:block; }
</style>

</body>
</html>
